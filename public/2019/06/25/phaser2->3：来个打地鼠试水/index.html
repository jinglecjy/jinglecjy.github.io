<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="前端"><title>phaser2-&gt;3：来个打地鼠试水 | Winnie Cai's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">phaser2-&gt;3：来个打地鼠试水</h1><a id="logo" href="/.">Winnie Cai's Blog</a><p class="description">生气了，一顿饭哄不好的那种。恩，要两顿。</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">phaser2-&gt;3：来个打地鼠试水</h1><div class="post-meta">Jun 25, 2019<span> | </span><span class="category"><a href="/categories/notes/">notes</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实现效果"><span class="toc-number">1.</span> <span class="toc-text">一、实现效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实现细节"><span class="toc-number">2.</span> <span class="toc-text">二、实现细节</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#第一步：初始化游戏new-Phaser-Game"><span class="toc-number">2.1.</span> <span class="toc-text">第一步：初始化游戏new Phaser.Game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二步：预加载资源"><span class="toc-number">2.2.</span> <span class="toc-text">第二步：预加载资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第三步：创建对象"><span class="toc-number">2.3.</span> <span class="toc-text">第三步：创建对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第四步：动画"><span class="toc-number">2.4.</span> <span class="toc-text">第四步：动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第五步：交互行为"><span class="toc-number">2.5.</span> <span class="toc-text">第五步：交互行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第六步：计时器"><span class="toc-number">2.6.</span> <span class="toc-text">第六步：计时器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、项目总结"><span class="toc-number">3.</span> <span class="toc-text">三、项目总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、参考文档"><span class="toc-number">4.</span> <span class="toc-text">六、参考文档</span></a></li></ol></div></div><div class="post-content"><blockquote>
<p>本文中phaser具体版本<br>    phaser2：2.8.1<br>    phaser3：3.17.0</p>
</blockquote>
<p><a href="#param1">一、实现效果</a><br><a href="#param2">二、实现细节</a><br><a href="#param3">三、项目总结</a><br><a href="#param4">四、参考文档</a>   </p>
<h2 id="一、实现效果"><a href="#一、实现效果" class="headerlink" title="一、实现效果"></a><i id="param1"></i>一、实现效果</h2><p><img src="https://img13.360buyimg.com/imagetools/jfs/t29857/279/1583344553/266188/c4b33b93/5ce4fca2N40bc5de6.gif" alt="效果图片"><br><img src="https://img14.360buyimg.com/imagetools/jfs/t1/67216/40/2877/17289/5d11d9f2E323511f3/e4ea982897f63823.png" alt="体验地址"><br><a href="https://github.com/winniecjy/phaser-dadishu/" target="_blank" rel="noopener">源码地址(phaser2&amp;phaser3)：https://github.com/winniecjy/phaser-dadishu/</a><br><a href="https://winniecjy.github.io/phaser-dadishu/ver-phaser2/dist/" target="_blank" rel="noopener">体验地址：https://winniecjy.github.io/phaser-dadishu/ver-phaser2/dist/</a>   </p>
<h2 id="二、实现细节"><a href="#二、实现细节" class="headerlink" title="二、实现细节"></a><i id="param2"></i>二、实现细节</h2><p>这个demo其实是之前学习phaser2的时候做的，现在用来改成phaser3，刚好可以接触一下新的API变动有多大。<br>按照游戏实现的逻辑顺序，下面捋一捋用到的Phaser3 API，同时也与Phaser2 API进行简单对比。     </p>
<h3 id="第一步：初始化游戏new-Phaser-Game"><a href="#第一步：初始化游戏new-Phaser-Game" class="headerlink" title="第一步：初始化游戏new Phaser.Game"></a>第一步：初始化游戏<code>new Phaser.Game</code></h3><p>初始化画布参数，包括画布宽高，渲染方式，并将其插入dom结构中。phaser3中用scenes替代了phaser2中的states，为了避免与state machines概念混淆。<br>游戏中的一个scene是一个独立的场景，拥有自己的独立资源，包括相机系统、显示列表、更新步骤、事件处理、物理系统等等。游戏一次只能执行一个scene，一个场景通过多个钩子函数来维护，包括init、preload、create、update等。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// phaser 3：https://photonstorm.github.io/phaser3-docs/Phaser.Types.Core.html#.GameConfig</span></span><br><span class="line">conf = &#123;</span><br><span class="line">  width: <span class="number">750</span>, </span><br><span class="line">  height: <span class="number">750</span>/<span class="built_in">window</span>.innerWidth*<span class="built_in">window</span>.innerHeight,</span><br><span class="line">  type: Phaser.AUTO, <span class="comment">// 渲染方法</span></span><br><span class="line">  parent: <span class="string">'container'</span>, <span class="comment">// 将包含游戏画布的dom元素</span></span><br><span class="line">  backgroundColor: <span class="string">'#f9c04c'</span>, </span><br><span class="line">  scale: &#123;</span><br><span class="line">      mode: Phaser.Scale.FIT <span class="comment">// 缩放模式，此处按比例调整画布大小，相当于contain</span></span><br><span class="line">  &#125;,</span><br><span class="line">  scene: &#123; <span class="comment">// 初始化场景，游戏最开始状态</span></span><br><span class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="comment">// 当场景开始时第一个执行，可以用于初始化变量或重定向到其他场景 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    preload: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="comment">// 第二个执行的函数，预加载游戏资源，不会在这里创建对象 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    create: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 当preload完成之后执行，preload的资源加载完成，可以在这里创建对象 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="comment">// 画布更新，在游戏的每一帧都执行 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// ...... 其他函数</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">game = <span class="keyword">new</span> Phaser.Game(conf);</span><br><span class="line"></span><br><span class="line"><span class="comment">// phaser 2：http://phaser.io/docs/2.6.2/Phaser.Game.html</span></span><br><span class="line">game = <span class="keyword">new</span> Phaser.Game(<span class="number">750</span>, <span class="number">750</span>/<span class="built_in">window</span>.innerWidth*<span class="built_in">window</span>.innerHeight, Phaser.AUTO, <span class="string">'container'</span>, </span><br><span class="line">  &#123; <span class="comment">// 初始化场景，游戏最开始状态</span></span><br><span class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="comment">// 当场景开始时第一个执行，可以用于初始化变量或重定向到其他场景 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    preload: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="comment">// 第二个执行的函数，预加载游戏资源，不会在这里创建对象 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    create: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 当preload完成之后执行，preload的资源加载完成，可以在这里创建对象 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="comment">// 画布更新，在游戏的每一帧都执行 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// ...... 其他函数</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="第二步：预加载资源"><a href="#第二步：预加载资源" class="headerlink" title="第二步：预加载资源"></a>第二步：预加载资源</h3><p>预加载资源操作一般在<code>preload</code>函数中执行，这一部分的API，phaser2和phaser3基本一致，不过phaser3对游戏对象结构进行了修改，phaser2中是树状结构，游戏中所有对象都来自于根对象<code>Phaser.Game</code>，对象也拥有自己的子对象。phaser3中将这些对象拆解出来，游戏对象<code>Phaser.Game</code>不包含其他对象组，且对象组不具有任何的位置或者属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// phaser3: https://photonstorm.github.io/phaser3-docs/Phaser.Loader.LoaderPlugin.html</span></span><br><span class="line">preload: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"start loading ..."</span>);</span><br><span class="line">    <span class="keyword">this</span>.numbersJson = <span class="built_in">require</span>(<span class="string">'../json/numbers.json'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// loader挂载在Phaser.Scene下</span></span><br><span class="line">    <span class="keyword">this</span>.load.image(<span class="string">'bg'</span>, <span class="string">'./img/holes-bg.png'</span>);</span><br><span class="line">    <span class="keyword">this</span>.load.image(<span class="string">'hamster'</span>, <span class="string">'./img/hamster.png'</span>);</span><br><span class="line">    <span class="keyword">this</span>.load.image(<span class="string">'hammer'</span>, <span class="string">'./img/hammer.png'</span>);</span><br><span class="line">    <span class="keyword">this</span>.load.image(<span class="string">'lightning'</span>, <span class="string">'./img/lightning.png'</span>);</span><br><span class="line">    <span class="keyword">this</span>.load.atlas(<span class="string">'sprite_numbers'</span>, <span class="string">'./img/numbers.png'</span>, <span class="keyword">this</span>.numbersJson);</span><br><span class="line">    <span class="keyword">this</span>.load.on(<span class="string">'complete'</span>, loadProgress);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">loadProgress</span>(<span class="params">loader, finishedNum</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;finishedNum&#125;</span>个资源加载完毕，可以开始游戏了！`</span>);</span><br><span class="line">        $(<span class="string">".cjy_panel .start_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 移除开始界面</span></span><br><span class="line">            $(<span class="string">".cjy_panel"</span>).hide();</span><br><span class="line">            customGame.scene.start(<span class="string">'play'</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// phaser2: http://phaser.io/docs/2.6.2/Phaser.Loader.html</span></span><br><span class="line">preload: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"start loading ..."</span>);</span><br><span class="line">  <span class="keyword">this</span>.numbersJson = <span class="built_in">require</span>(<span class="string">'../json/numbers.json'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.customGame)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 这些属性在Phaser3中已被移除，需要通过初始化配置</span></span><br><span class="line">  <span class="built_in">window</span>.customGame.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;</span><br><span class="line">  <span class="built_in">window</span>.customGame.stage.backgroundColor = <span class="string">'#f9c04c'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// loader挂载在Phaser.game下</span></span><br><span class="line">  <span class="built_in">window</span>.customGame.load.image(<span class="string">'bg'</span>, <span class="string">'./img/holes-bg.png'</span>);</span><br><span class="line">  <span class="built_in">window</span>.customGame.load.image(<span class="string">'hamster'</span>, <span class="string">'./img/hamster.png'</span>);</span><br><span class="line">  <span class="built_in">window</span>.customGame.load.image(<span class="string">'hammer'</span>, <span class="string">'./img/hammer.png'</span>);</span><br><span class="line">  <span class="built_in">window</span>.customGame.load.image(<span class="string">'lightning'</span>, <span class="string">'./img/lightning.png'</span>);</span><br><span class="line">  <span class="built_in">window</span>.customGame.load.atlasJSONHash(<span class="string">'sprite_numbers'</span>, <span class="string">'./img/numbers.png'</span>, <span class="string">''</span>, <span class="keyword">this</span>.numbersJson);</span><br><span class="line">  <span class="built_in">window</span>.customGame.load.onLoadComplete.add(loadProgress, <span class="keyword">this</span>);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">loadProgress</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'资源加载完毕，可以开始游戏啦！'</span>)</span><br><span class="line">    $(<span class="string">".cjy_panel .start_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"开始游戏！"</span>);</span><br><span class="line">        <span class="comment">// 移除开始界面</span></span><br><span class="line">        $(<span class="string">".cjy_panel"</span>).hide();</span><br><span class="line">        customGame.state.start(<span class="string">'play'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="第三步：创建对象"><a href="#第三步：创建对象" class="headerlink" title="第三步：创建对象"></a>第三步：创建对象</h3><p>创建对象操作一般在<code>create</code>函数中执行，这一部分的API基本一致，差别与<code>load</code>相似，都是由于修改了整体数据结构导致的。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// phaser3: https://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.GameObjectCreator.html</span></span><br><span class="line"><span class="comment">// 对象的创建</span></span><br><span class="line"><span class="keyword">this</span>.hammer = <span class="keyword">this</span>.add.sprite(hammerx, hammery, <span class="string">'hammer'</span>).setOrigin(<span class="number">0</span>, <span class="number">0.8</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// phaser2: http://phaser.io/docs/2.6.2/Phaser.GameObjectFactory.html</span></span><br><span class="line"><span class="keyword">this</span>.hammer = customGame.add.sprite(hammerx, hammery, <span class="string">'hammer'</span>);</span><br><span class="line"><span class="keyword">this</span>.hammer.anchor.setTo(<span class="number">0</span>, <span class="number">0.8</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="第四步：动画"><a href="#第四步：动画" class="headerlink" title="第四步：动画"></a>第四步：动画</h3><p>phaser2和phaser3都提供了内置tween动画供开发者使用，相比较于phaser2，phaser3中的tween动画配置更加灵活丰富，具体完整的配置项列表可以参照<a href="https://photonstorm.github.io/phaser3-docs/Phaser.Types.Tweens.html#.TweenBuilderConfig" target="_blank" rel="noopener">官方文档</a>。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// phaser3: https://photonstorm.github.io/phaser3-docs/Phaser.Tweens.TweenManager.html</span></span><br><span class="line"><span class="keyword">this</span>.tweens.add(&#123;</span><br><span class="line">  targets: [<span class="keyword">this</span>.hammer],</span><br><span class="line">  angle: <span class="number">45</span>,</span><br><span class="line">  duration: <span class="number">50</span>,</span><br><span class="line">  callbackScope: <span class="keyword">this</span>,</span><br><span class="line">  ease: <span class="string">'Linear'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// phaser2: http://phaser.io/docs/2.6.2/Phaser.Tween.html</span></span><br><span class="line"><span class="keyword">var</span> rotateTween = customGame.add.tween(<span class="keyword">this</span>.hammer);</span><br><span class="line">rotateTween.to(&#123;</span><br><span class="line">    angle: <span class="number">45</span></span><br><span class="line">&#125;, <span class="number">50</span>, Phaser.Easing.Cubic.In, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="第五步：交互行为"><a href="#第五步：交互行为" class="headerlink" title="第五步：交互行为"></a>第五步：交互行为</h3><p>phaser本身没有dom概念，所有的交互都需要依赖phaser自身的API，通过<code>Phaser.Input</code>统一管理所有的input事件。当交互发生时，与之交互的<code>Phaser.Game</code>对象将向下分发事件，phaser3可以在scene/gameObject中监听该事件，不同的位置监听事件其作用域不同，优先级也不同，优先级较高的事件处理器可阻止向低优先级事件传递（stop propagation）。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// phaser3: https://photonstorm.github.io/phaser3-docs/Phaser.Input.Events.html</span></span><br><span class="line"><span class="keyword">this</span>.input.on(<span class="string">'pointerdown'</span>, onTap, <span class="keyword">this</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onTap</span>(<span class="params">pointer,currentlyOver</span>) </span>&#123; ... &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// phaser2: http://phaser.io/docs/2.6.2/Phaser.Input.html</span></span><br><span class="line">customGame.input.onTap.add(onTap, <span class="keyword">this</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onTap</span>(<span class="params">pointer, doubleTap</span>) </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="第六步：计时器"><a href="#第六步：计时器" class="headerlink" title="第六步：计时器"></a>第六步：计时器</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// phaser3: https://photonstorm.github.io/phaser3-docs/Phaser.Time.TimerEvent.html</span></span><br><span class="line"><span class="keyword">this</span>.time.addEvent(&#123;</span><br><span class="line">  loop: <span class="literal">true</span>,</span><br><span class="line">  delay: <span class="number">1000</span>,</span><br><span class="line">  callback: timerFn,</span><br><span class="line">  callbackScope: <span class="keyword">this</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// phaser2: http://phaser.io/docs/2.6.2/Phaser.Timer.html#loop</span></span><br><span class="line">customGame.time.events.loop(Phaser.Timer.SECOND, <span class="keyword">this</span>.timerFn, <span class="keyword">this</span>); <span class="comment">//利用时钟对象来重复产生管道</span></span><br><span class="line">customGame.time.events.start();</span><br></pre></td></tr></table></figure>
<h2 id="三、项目总结"><a href="#三、项目总结" class="headerlink" title="三、项目总结"></a><i id="param3"></i>三、项目总结</h2><p>一些可以改进优化的细节：     </p>
<ul>
<li>【前端】资源预加载与游戏过程应当在同一个scene中，之前没捋清楚逻辑，把这两个步骤拆开了    </li>
<li>【交互】疯狂点击页面会出现很多个小锤子，短时间内多次点击应该只响应一次</li>
<li>【交互】打到地鼠时的反馈感加强，比如地鼠有晕眩动效/音效提示/+1效果等等   </li>
<li>【玩法】地鼠出现时间越来越快   </li>
<li>【玩法】主角多样化，除了地鼠还可以有炸弹/手拿礼物的地鼠/其他道具，分数不同     </li>
</ul>
<p>phaser2上手较快，API简单，官方文档示例比较丰富，值得继续探索，后续会试水一下物理引擎。phaser3是正在开发的版本，相较于phaser2 API变化较多，文档完善度不够，基本上是查源码猜API。试水过程可以感受到phaser3对API设计重新考量，比如用对象来代替原有的基本数据类型作为函数参数，可读性和灵活性更佳。另外，phaser3增强了camera的功能，新增了对Matter.js物理引擎的支持，对2D骨骼动画的支持等等，此处不进行赘述，详细的可以查看phaser官网的具体公告，或者是参考文章 <a href="https://aotu.io/notes/2018/12/23/phaser3/" target="_blank" rel="noopener">全新Phaser3游戏引擎特性一览（来自凹凸实验室）</a> 。<br>关于自学：个人觉得phaser API的学习方法最直观的是在控制台打印一下，尤其是对于初学者来说，对于其中的结构没有清晰的认识，直接看文档容易混乱，具体使用也可以参照<a href="https://labs.phaser.io/" target="_blank" rel="noopener">官方示例</a>。<br>彩虹屁结束之后，不得不说，如果是项目实际使用，建议还是使用稳定版本phaser2，简单的小游戏还是够用的。   </p>
<h2 id="六、参考文档"><a href="#六、参考文档" class="headerlink" title="六、参考文档"></a><i id="param4"></i>六、参考文档</h2><ol>
<li><a href="http://phaser.io/" target="_blank" rel="noopener">Phaser官网：http://phaser.io/</a></li>
<li><a href="http://phaser.io/docs/2.6.2/index" target="_blank" rel="noopener">Phaser2 API文档：http://phaser.io/docs/2.6.2/index</a></li>
<li><a href="https://photonstorm.github.io/phaser3-docs/" target="_blank" rel="noopener">Phaser3 API文档：https://photonstorm.github.io/phaser3-docs/</a></li>
<li><a href="https://labs.phaser.io/" target="_blank" rel="noopener">Phaser3官方示例：https://labs.phaser.io/</a></li>
<li><a href="https://aotu.io/notes/2018/12/23/phaser3/" target="_blank" rel="noopener">全新Phaser3游戏引擎特性一览：https://aotu.io/notes/2018/12/23/phaser3/</a></li>
</ol>
</div><div class="tags"><a href="/tags/小项目/">小项目</a><a href="/tags/phaser/">phaser</a></div><div class="post-nav"><a class="pre" href="/2019/06/27/赶鸭子上架的全栈开发踩坑思考/">赶鸭子上架的全栈开发踩坑思考</a><a class="next" href="/2019/03/14/优化动画卡顿：卡顿原因分析及优化方案/">优化动画卡顿：卡顿原因分析及优化方案</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/intensive-study/">intensive study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lesson/">lesson</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/notes/">notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/review/">review</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue组件/">vue组件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/weekly/">weekly</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/compass/" style="font-size: 15px;">compass</a> <a href="/tags/threejs/" style="font-size: 15px;">threejs</a> <a href="/tags/周报/" style="font-size: 15px;">周报</a> <a href="/tags/vue/" style="font-size: 15px;">vue</a> <a href="/tags/组件沉淀/" style="font-size: 15px;">组件沉淀</a> <a href="/tags/phaser/" style="font-size: 15px;">phaser</a> <a href="/tags/sass/" style="font-size: 15px;">sass</a> <a href="/tags/小项目/" style="font-size: 15px;">小项目</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/数据分析工具项目/" style="font-size: 15px;">数据分析工具项目</a> <a href="/tags/项目复盘/" style="font-size: 15px;">项目复盘</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/工具/" style="font-size: 15px;">工具</a> <a href="/tags/记录/" style="font-size: 15px;">记录</a> <a href="/tags/日常研究/" style="font-size: 15px;">日常研究</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/12/23/Vue组件库之Popup弹窗组件/">vue组件库之popup弹窗组件</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/19/算法应用之自定义公式计算/">算法应用之自定义公式计算</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/05/记录之MAC环境下一次重新安装nvm和nrm/">记录之MAC环境下一次重新安装nvm和nrm</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/05/记录第一次typescript重构后端/">记录第一次typescript重构后端</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/27/赶鸭子上架的全栈开发踩坑思考/">赶鸭子上架的全栈开发踩坑思考</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/25/phaser2->3：来个打地鼠试水/">phaser2->3：来个打地鼠试水</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/14/优化动画卡顿：卡顿原因分析及优化方案/">优化动画卡顿：卡顿原因分析及优化方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/08/两周一报14（20190308）/">两周一报14（20190308）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/22/两周一报13（20190222）/">两周一报13（20190222）</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/25/两周一报12（20190125）/">两周一报12（20190125）</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Winnie Cai's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>